Add-Type @"
using System;
using System.Runtime.InteropServices;
using Microsoft.Win32;
namespace Wallpaper
{
   public class Setter {
      [DllImport("user32.dll", SetLastError = true, CharSet = CharSet.Auto)]
      private static extern int SystemParametersInfo (int uAction, int uParam, string lpvParam, int fuWinIni);
      
      public static void SetWallpaper (string path) {
         SystemParametersInfo(20, 0, path, 0x01 | 0x02);
         RegistryKey key = Registry.CurrentUser.OpenSubKey("Control Panel\\Desktop", true);
         key.SetValue(@"WallpaperStyle", "6"); 
         key.SetValue(@"TileWallpaper", "0");
         key.Close();
      }
   }
}
"@

[Wallpaper.Setter]::SetWallpaper( 'C:\Users\F668631\Desktop\Heniu2.jpg')
